code = '''int __cdecl main(int argc, const char **argv, const char **envp)
{
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // eax
  int v15; // eax
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // eax
  int v20; // eax
  int v21; // eax
  int v22; // eax
  int v23; // eax
  int v24; // eax
  int v25; // eax
  int v26; // eax
  int v27; // eax
  int v28; // eax
  int v29; // eax
  int v30; // eax
  int v31; // eax
  int v32; // eax
  int v33; // eax
  int v34; // eax
  int v35; // eax
  int v36; // eax
  int v37; // eax
  int v38; // eax
  int v39; // eax
  int v40; // eax
  int v42; // [rsp+24h] [rbp-34h]
  int v43; // [rsp+2Ch] [rbp-2Ch]
  char *Str; // [rsp+30h] [rbp-28h]
  size_t v45; // [rsp+50h] [rbp-8h]

  Str = (char *)argv[1];
  v45 = strlen(Str);
  v42 = -1331718747;
  while ( 1 )
  {
    while ( 1 )
    {
      while ( 1 )
      {
        while ( 1 )
        {
          while ( 1 )
          {
            while ( 1 )
            {
              while ( 1 )
              {
                while ( 1 )
                {
                  while ( 1 )
                  {
                    while ( 1 )
                    {
                      while ( 1 )
                      {
                        while ( 1 )
                        {
                          while ( 1 )
                          {
                            while ( 1 )
                            {
                              while ( 1 )
                              {
                                while ( 1 )
                                {
                                  while ( 1 )
                                  {
                                    while ( 1 )
                                    {
                                      while ( v42 == -2137645213 )
                                      {
                                        ++v43;
                                        v42 = 1149423608;
                                      }
                                      if ( v42 != -2049561539 )
                                        break;
                                      v17 = -2031250773;
                                      if ( 146328 * (*Str - 49) == 7755384 )
                                        v17 = 1388161969;
                                      v42 = v17;
                                    }
                                    if ( v42 != -2041990394 )
                                      break;
                                    v37 = -1238465216;
                                    if ( 86 * (Str[25] - 97 + 55) == 5160 )
                                      v37 = -1132408623;
                                    v42 = v37;
                                  }
                                  if ( v42 != -2031250773 )
                                    break;
                                  v18 = 1617303995;
                                  if ( 30 * (Str[23] + 124) == 5070 )
                                    v18 = 2051439051;
                                  v42 = v18;
                                }
                                if ( v42 != -1863926413 )
                                  break;
                                ++v43;
                                v42 = 1924505610;
                              }
                              if ( v42 != -1846290169 )
                                break;
                              ++v43;
                              v42 = 769774846;
                            }
                            if ( v42 != -1844772716 )
                              break;
                            sub_140002600("Your flag is flag{%s}\n", Str);
                            v42 = -421242958;
                          }
                          if ( v42 != -1804989338 )
                            break;
                          v5 = 231362178;
                          if ( Str[15] == 56 )
                            v5 = -723147593;
                          v42 = v5;
                        }
                        if ( v42 != -1804771480 )
                          break;
                        v12 = -1751818282;
                        if ( 88 * (Str[14] - 7 + 81) == 11088 )
                          v12 = -176228145;
                        v42 = v12;
                      }
                      if ( v42 != -1753122264 )
                        break;
                      v21 = -238503082;
                      if ( Str[24] == 97 )
                        v21 = 821492842;
                      v42 = v21;
                    }
                    if ( v42 != -1751818282 )
                      break;
                    v13 = 1913034559;
                    if ( 86 * (27 * Str[19] - 33 + 44) == 130978 )
                      v13 = -1505117222;
                    v42 = v13;
                  }
                  if ( v42 != -1523296944 )
                    break;
                  ++v43;
                  v42 = 636257875;
                }
                if ( v42 != -1506427618 )
                  break;
                ++v43;
                v42 = 64662368;
              }
              if ( v42 != -1505117222 )
                break;
              ++v43;
              v42 = 1913034559;
            }
            if ( v42 != -1359362189 )
              break;
            sub_140002600("Try harder!\n");
            v42 = -421242958;
          }
          if ( v42 != -1331718747 )
            break;
          v3 = -484915722;
          if ( v45 != 36 )
            v3 = -1124533225;
          v42 = v3;
        }
        if ( v42 != -1238465216 )
          break;
        v38 = 64662368;
        if ( 4482 * (Str[26] - 17) == 372006 )
          v38 = -1506427618;
        v42 = v38;
      }
      if ( v42 != -1151151873 )
        break;
      v35 = 585887301;
      if ( Str[27] == 100 )
        v35 = 182804467;
      v42 = v35;
    }
    if ( v42 == -1143856910 )
      break;
    switch ( v42 )
    {
      case -1132408623:
        ++v43;
        v42 = -1238465216;
        break;
      case -1124533225:
        sub_140002600("Try harder!\n");
        v42 = -1143856910;
        break;
      case -1075879616:
        ++v43;
        v42 = -579663628;
        break;
      case -1048778023:
        ++v43;
        v42 = -1804989338;
        break;
      case -958186987:
        ++v43;
        v42 = -1151151873;
        break;
      case -933014110:
        v34 = -1151151873;
        if ( Str[17] == 99 )
          v34 = -958186987;
        v42 = v34;
        break;
      case -821254739:
        v25 = 636257875;
        if ( 22 * Str[5] == 1166 )
          v25 = -1523296944;
        v42 = v25;
        break;
      case -820169732:
        v20 = -1753122264;
        if ( 19 * Str[21] == 931 )
          v20 = 1396463423;
        v42 = v20;
        break;
      case -723147593:
        ++v43;
        v42 = 231362178;
        break;
      case -690435285:
        v30 = 277216217;
        if ( Str[6] == 99 )
          v30 = 1938630176;
        v42 = v30;
        break;
      case -579663628:
        v28 = 1137755524;
        if ( 1800 * Str[4] == 95400 )
          v28 = 514576238;
        v42 = v28;
        break;
      case -577513872:
        v9 = 769774846;
        if ( Str[11] == 99 )
          v9 = -1846290169;
        v42 = v9;
        break;
      case -528231342:
        v15 = 1505854918;
        if ( 22 * Str[30] == 1100 )
          v15 = -118867646;
        v42 = v15;
        break;
      case -526927560:
        ++v43;
        v42 = 2052466890;
        break;
      case -501747298:
        ++v43;
        v42 = 785583996;
        break;
      case -484915722:
        v43 = 0;
        v4 = -1804989338;
        if ( 3 * (Str[32] + 23) == 231 )
          v4 = -1048778023;
        v42 = v4;
        break;
      case -421242958:
        v42 = -1143856910;
        break;
      case -408265023:
        ++v43;
        v42 = 1188310040;
        break;
      case -373400163:
        ++v43;
        v42 = -933014110;
        break;
      case -318048657:
        ++v43;
        v42 = 1791168491;
        break;
      case -275509961:
        v23 = 785583996;
        if ( 99 * (Str[9] + 88) == 14355 )
          v23 = -501747298;
        v42 = v23;
        break;
      case -238503082:
        v22 = -275509961;
        if ( 35 * (66 * Str[16] - 77) == 230615 )
          v22 = 1478578209;
        v42 = v22;
        break;
      case -176228145:
        ++v43;
        v42 = -1751818282;
        break;
      case -118867646:
        ++v43;
        v42 = 1505854918;
        break;
      case 64662368:
        v39 = 1791168491;
        if ( Str[29] == 100 )
          v39 = -318048657;
        v42 = v39;
        break;
      case 113483495:
        ++v43;
        v42 = -2041990394;
        break;
      case 182804467:
        ++v43;
        v42 = 585887301;
        break;
      case 231362178:
        v6 = 2052466890;
        if ( Str[12] == 57 )
          v6 = -526927560;
        v42 = v6;
        break;
      case 277216217:
        v31 = 1149423608;
        if ( Str[31] == 56 )
          v31 = -2137645213;
        v42 = v31;
        break;
      case 419558119:
        ++v43;
        v42 = -1804771480;
        break;
      case 514576238:
        ++v43;
        v42 = 1137755524;
        break;
      case 585887301:
        v36 = -2041990394;
        if ( 74 * (Str[22] + 185) == 17612 )
          v36 = 113483495;
        v42 = v36;
        break;
      case 613726951:
        v33 = -933014110;
        if ( 19 * (73 * Str[1] - 18) == 135584 )
          v33 = -373400163;
        v42 = v33;
        break;
      case 625879060:
        ++v43;
        v42 = -820169732;
        break;
      case 636257875:
        v26 = 1924505610;
        if ( Str[18] == 45 )
          v26 = -1863926413;
        v42 = v26;
        break;
      case 769774846:
        v10 = 1188310040;
        if ( 52 * (Str[10] + 95) == 10244 )
          v10 = -408265023;
        v42 = v10;
        break;
      case 785583996:
        v24 = -821254739;
        if ( 14 * (Str[8] - 106) == -854 )
          v24 = 1510073875;
        v42 = v24;
        break;
      case 821492842:
        ++v43;
        v42 = -238503082;
        break;
      case 866893295:
        ++v43;
        v42 = -528231342;
        break;
      case 1086424513:
        ++v43;
        v42 = -577513872;
        break;
      case 1137755524:
        v29 = -690435285;
        if ( 3 * (Str[7] - 47) == 21 )
          v29 = 1474341944;
        v42 = v29;
        break;
      case 1149423608:
        v32 = 613726951;
        if ( Str[34] == 56 )
          v32 = 2131303034;
        v42 = v32;
        break;
      case 1188310040:
        v11 = -1804771480;
        if ( Str[20] == 98 )
          v11 = 419558119;
        v42 = v11;
        break;
      case 1203897811:
        ++v43;
        v42 = -2049561539;
        break;
      case 1328231675:
        ++v43;
        v42 = 1606970733;
        break;
      case 1388161969:
        ++v43;
        v42 = -2031250773;
        break;
      case 1396463423:
        ++v43;
        v42 = -1753122264;
        break;
      case 1474341944:
        ++v43;
        v42 = -690435285;
        break;
      case 1478578209:
        ++v43;
        v42 = -275509961;
        break;
      case 1505854918:
        v16 = -2049561539;
        if ( 82 * (19 * Str[35] - 40) == 154078 )
          v16 = 1203897811;
        v42 = v16;
        break;
      case 1510073875:
        ++v43;
        v42 = -821254739;
        break;
      case 1606970733:
        v8 = -577513872;
        if ( 37 * (14 * Str[2] + 6) == 26640 )
          v8 = 1086424513;
        v42 = v8;
        break;
      case 1617303995:
        v19 = -820169732;
        if ( Str[13] == 45 )
          v19 = 625879060;
        v42 = v19;
        break;
      case 1791168491:
        v40 = -1359362189;
        if ( v43 == 36 )
          v40 = -1844772716;
        v42 = v40;
        break;
      case 1913034559:
        v14 = -528231342;
        if ( Str[28] == 53 )
          v14 = 866893295;
        v42 = v14;
        break;
      case 1924505610:
        v27 = -579663628;
        if ( 29 * (Str[3] - 14) == 2436 )
          v27 = -1075879616;
        v42 = v27;
        break;
      case 1938630176:
        ++v43;
        v42 = 277216217;
        break;
      case 2051439051:
        ++v43;
        v42 = 1617303995;
        break;
      case 2052466890:
        v7 = 1606970733;
        if ( 79 * (Str[33] + 185) == 22673 )
          v7 = 1328231675;
        v42 = v7;
        break;
      default:
        ++v43;
        v42 = 613726951;
        break;
    }
  }
  return 0;
}'''.replace('*Str', 'Str[0]')

import re
constraints = list(filter(lambda x: 'Str' in x, re.findall('\s+if \( (.*?) \)', code)))
print(constraints)
print(len(constraints))

from z3 import *

Str = [BitVec('Str[{}]'.format(i), 32) for i in range(36)]

s = Solver()

for c in constraints:
    s.add(eval(c))

print(s.check())
m = s.model()
# print(m)
flag = ''
for i in range(36):
    flag += chr(m[Str[i]].as_long())
print(flag)

